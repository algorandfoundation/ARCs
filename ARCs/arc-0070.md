---
arc: 70
title: Add Integrity & Mime Type to Digital Media ASA
description: Add mandatory validation fields to allow checking the validity of media.
author: Fabrice Benhamouda (@fabrice102)
discussions-to: https://github.com/algorandfoundation/ARCs/issues/64
status: Draft
type: Standards Track
category: ARC
created: 2021-08-07
requires: 69
---

## Abstract

This convention adds Integrity & Mime Type fields to [ARC-69](./arc-0069.md) assets. It helps clients to fetch and render media more effectively and allow checking the validity of downloaded media even if the source becomes unavailable.

## Specification

The key words "**MUST**", "**MUST NOT**", "**REQUIRED**", "**SHALL**", "**SHALL NOT**", "**SHOULD**", "**SHOULD NOT**", "**RECOMMENDED**", "**MAY**", and "**OPTIONAL**" in this document are to be interpreted as described in <a href="https://www.ietf.org/rfc/rfc2119.txt">RFC-2119</a>.

### JSON Metadata File Schema

```json
{
    ...
    "properties": {
        "standard": {
            "type": "string",
            "value": "arc69",
            "description": "(Required) Describes the standard used.",
            "validation": "arc70"
        },
        ...
        "mime_type": {
            "type": "string",
            "description": "The MIME type of the ASA's URL (`au` field)."
        },
        "integrity": {
            "type": "string",
            "description": "The SHA-256 digest of the file pointed by the ASA's URL (`au` field)"
        },
        "media_mime_type": {
            "type": "string",
            "description": "The MIME type of the file pointed by the URI media_url."
        },
        "media_integrity": {
            "type": "string",
            "description": "The SHA-256 digest of the file pointed by the URI media_url. "
        }
    }
}
```
The `standard` field is **REQUIRED** and the `value` **MUST** be equal to `arc69` and the `validation` **MUST** be equal to `arc70`. 

The `mime_type` field is **REQUIRED** and **MUST** be equal to the MIME type of the ASA's URL (`au` field).
The `integrity` field is **REQUIRED** and **MUST** be equal to the SHA-256 digest of the file pointed by the ASA's URL (`au` field). The field value is a single SHA-256 integrity metadata as defined in the <a href="https://w3c.github.io/webappsec-subresource-integrity">W3C subresource integrity specification</a>.

The `media_mime_type` field is **REQUIRED** if a `media_url` is provided and **MUST** be equal to the MIME type of the file pointed by the URI `media_url`.
The `media_integrity` field is **REQUIRED** if a `media_url` is provided and **MUST** be equal to the SHA-256 digest of the file pointed by the URI `media_url`. The field value is a single SHA-256 integrity metadata as defined in the <a href="https://w3c.github.io/webappsec-subresource-integrity">W3C subresource integrity specification</a>.


All other fields are **OPTIONAL**. If provided, the other fields **MUST** match the description in the ARC-69 JSON schema.

### MIME Type

In addition to specifying a data type in the ASA's URL (`au` field) with a URI fragment (ex: `#v` for video), the JSON Metadata schema also allows indication of the URL's MIME type (ex: `video/mp4`) via the `mime_type` field.

Similarly, the high resolution version of the asset's media pointed by `media_url` also allows the indication of its MIME type via the `media_mime_type` field.

It is **REQUIRED** to specify these MIME type fields when appropriate to help clients. 

### Integrity

The JSON Metadata schema allows to indicate digests of the files pointed by the ASA's URL (`au` field) and the high resolution version of the asset's media pointed by `media_url`, via the fields `integrity` and `media_integrity`.
This is to ensure the integrity of those files.

The digests are represented as a single SHA-256 integrity metadata as defined in the <a href="https://w3c.github.io/webappsec-subresource-integrity">W3C subresource integrity specification</a>.

Details on how to generate those digests can be found on the <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity">MDN Web Docs</a> (where `sha384` or `384` are to be replaced by `sha256` and `256` respectively as only SHA-256 is supported by this ARC).

It is **REQUIRED** to specify these integrity fields, in order to allow clients to verify the integrity of downloaded assets if the original source is no more available.

## Rationale
* MIME types help clients more effectively fetch and render media.
* Integrity fields allow to check the validity of downloaded media even if the original source becomes unavailable.

## Security Considerations

Clients **MUST NOT** rely on the MIME type fields from a security perspective and **MUST NOT** break or fail if the fields are incorrect (beyond not displaying the media correctly). In particular, Clients **MUST** take all necessary security measures to protect users against remote code execution or cross-site scripting attacks, even when the MIME type looks innocuous (like `image/png`).

> The above restriction is to protect clients and users against malformed or malicious ARC-69.

## Copyright

Copyright and related rights waived via <a href="https://creativecommons.org/publicdomain/zero/1.0/">CCO</a>.
